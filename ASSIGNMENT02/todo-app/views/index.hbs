{{> header}}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>My Tasks ({{tasks.length}})</h2>
    <a href="/tasks/add" class="btn btn-primary">+ Add Task</a>
</div>

{{#if error}}
<div class="alert alert-danger">{{error}}</div>
{{/if}}

{{#if tasks.length}}
{{#each tasks}}
<div class="card mb-3">
    <div class="card-body d-flex justify-content-between align-items-start">
        <div class="flex-grow-1">
            <h5 class="card-title {{#if completed}}text-decoration-line-through text-muted{{/if}}">
                {{title}}
            </h5>
            {{#if description}}
            <p class="card-text">{{description}}</p>
            {{/if}}
            <div class="text-muted small">
                {{#if dueDate}}
                Due: {{formatDate dueDate}}
                {{else}}
                No due date
                {{/if}}
                {{#if completed}} â€¢ Completed{{/if}}
            </div>
        </div>
        <div class="btn-group btn-group-sm">
            <a href="/tasks/edit/{{_id}}" class="btn btn-outline-primary">Edit</a>
            <form method="POST" action="/tasks/{{_id}}/toggle" style="display:inline;"
                onsubmit="return confirm('Mark as {{#if completed}}incomplete{{else}}complete{{/if}}?')">
                <button type="submit" class="btn {{#if completed}}btn-success{{else}}btn-outline-success{{/if}}">
                    {{#if completed}}Undo{{else}}Complete{{/if}}
                </button>
            </form>
            <form method="POST" action="/tasks/delete/{{_id}}" style="display:inline;"
                onsubmit="return confirm('Delete this task?')">
                <button type="submit" class="btn btn-outline-danger">Delete</button>
            </form>
        </div>
    </div>
</div>
{{/each}}
{{else}}
<div class="text-center py-5">
    <i class="fas fa-tasks fa-3x text-muted mb-3"></i>
    <h4>No tasks yet</h4>
    <p class="text-muted">Get started by adding your first task!</p>
    <a href="/tasks/add" class="btn btn-primary">+ Create First Task</a>
</div>
{{/if}}
{{> footer}}